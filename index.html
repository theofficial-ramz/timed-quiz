<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Timed Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    #timer { font-size: 2em; margin-bottom: 20px; color: #e74c3c; }
    iframe { border: none; width: 100%; height: 800px; }
  </style>
</head>
<body>
  <h1>üìù Quiz Timer</h1>
  <div id="timer">05:00</div>

  <!-- Form iframe con param Start Time -->
  <iframe id="quizFrame"></iframe>

  <script>
    const iframe = document.getElementById('quizFrame');
    const timerDisplay = document.getElementById('timer');

    // Salva il timestamp di apertura
    const startTime = new Date().toISOString();

    // Google Form base link
    const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSeDN_e-sodNo07Jc5kSYXXWvSVNAZzPFdE9wWbUFq6SrwUtGA/viewform?usp=pp_url&entry.877932747=";

    // Imposta iframe src con startTime precompilato
    iframe.src = formBase + encodeURIComponent(startTime);

    // Timer 5 minuti
    let seconds = 5 * 60;
    const interval = setInterval(() => {
      seconds--;
      const min = Math.floor(seconds / 60);
      const sec = seconds % 60;
      timerDisplay.textContent = `${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;

      if(seconds <= 0){
        clearInterval(interval);
        timerDisplay.textContent = "‚è∞ Time is up!";
        alert("Time is up! The form is now closed.");
        // Nascondi iframe
        iframe.style.display = "none";

        // Qui potresti eventualmente loggare l'evento su un server o chiamare un webhook se vuoi
        // es: fetch("https://tuo-server.com/logtime?start=" + startTime + "&end=" + new Date().toISOString())
      }
    }, 1000);
  </script>
</body>
</html>
